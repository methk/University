import RadixECIES from '../crypto/RadixECIES';
import RadixIdentity from './RadixIdentity';
import RadixAccount from '../account/RadixAccount';
export default class RadixSimpleIdentity extends RadixIdentity {
    constructor(keyPair) {
        super();
        this.keyPair = keyPair;
        this.account = new RadixAccount(keyPair);
        this.account.enableDecryption(this);
    }
    async signAtom(atom) {
        const signature = this.keyPair.sign(atom.getHash());
        const signatureId = this.keyPair.getUID();
        atom.signatures = { [signatureId.toString()]: signature };
        return atom;
    }
    async decryptECIESPayload(payload) {
        return RadixECIES.decrypt(this.keyPair.getPrivate(), payload);
    }
    getPublicKey() {
        return Buffer.from(this.keyPair.keyPair.getPublic().encode('be', true));
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUmFkaXhTaW1wbGVJZGVudGl0eS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9tb2R1bGVzL2lkZW50aXR5L1JhZGl4U2ltcGxlSWRlbnRpdHkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxVQUFVLE1BQU0sc0JBQXNCLENBQUE7QUFDN0MsT0FBTyxhQUFhLE1BQU0saUJBQWlCLENBQUE7QUFDM0MsT0FBTyxZQUFZLE1BQU0seUJBQXlCLENBQUE7QUFJbEQsTUFBTSxDQUFDLE9BQU8sT0FBTyxtQkFBb0IsU0FBUSxhQUFhO0lBQzFELFlBQXFCLE9BQXFCO1FBQ3RDLEtBQUssRUFBRSxDQUFBO1FBRFUsWUFBTyxHQUFQLE9BQU8sQ0FBYztRQUd0QyxJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksWUFBWSxDQUFDLE9BQU8sQ0FBQyxDQUFBO1FBRXhDLElBQUksQ0FBQyxPQUFPLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLENBQUE7SUFDdkMsQ0FBQztJQUVNLEtBQUssQ0FBQyxRQUFRLENBQUMsSUFBZTtRQUNqQyxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQTtRQUNuRCxNQUFNLFdBQVcsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sRUFBRSxDQUFBO1FBRXpDLElBQUksQ0FBQyxVQUFVLEdBQUcsRUFBRSxDQUFDLFdBQVcsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxFQUFFLFNBQVMsRUFBRSxDQUFBO1FBRXpELE9BQU8sSUFBSSxDQUFBO0lBQ2YsQ0FBQztJQUVNLEtBQUssQ0FBQyxtQkFBbUIsQ0FBQyxPQUFlO1FBQzVDLE9BQU8sVUFBVSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBRSxFQUFFLE9BQU8sQ0FBQyxDQUFBO0lBQ2pFLENBQUM7SUFFTSxZQUFZO1FBQ2YsT0FBTyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQTtJQUMzRSxDQUFDO0NBQ0oifQ==