import RadixECIES from './RadixECIES';
import { RadixBasicContainer } from '../RadixAtomModel';
import { logger } from '../common/RadixLogger';
export default class RadixEncryptor extends RadixBasicContainer {
    constructor(json) {
        super(json);
        this.serializationProperties.push('protectors');
    }
    getKey(accessor) {
        for (let protector of this.protectors) {
            try {
                let decryptedPrivateKey = RadixECIES.decrypt(accessor.keyPair.getPrivate(), protector.data);
                return decryptedPrivateKey;
            }
            catch (error) {
                logger.error('Couldn\'t decrypt:', error);
            }
        }
        throw new Error('Could not decrypt any protectors');
    }
    decrypt(data, accessor) {
        let privateKey = this.getKey(accessor);
        return RadixECIES.decrypt(privateKey, data.data);
    }
}
RadixEncryptor.SERIALIZER = 105401064;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUmFkaXhFbmNyeXB0b3IuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvbW9kdWxlcy9jcnlwdG8vUmFkaXhFbmNyeXB0b3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxVQUFVLE1BQU0sY0FBYyxDQUFBO0FBRXJDLE9BQU8sRUFBRSxtQkFBbUIsRUFBNkIsTUFBTSxtQkFBbUIsQ0FBQTtBQUNsRixPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sdUJBQXVCLENBQUE7QUFFOUMsTUFBTSxDQUFDLE9BQU8sT0FBTyxjQUFlLFNBQVEsbUJBQW1CO0lBSzNELFlBQVksSUFBYTtRQUNyQixLQUFLLENBQUMsSUFBSSxDQUFDLENBQUE7UUFFWCxJQUFJLENBQUMsdUJBQXVCLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFBO0lBQ25ELENBQUM7SUFFRCxNQUFNLENBQUMsUUFBc0I7UUFDekIsS0FBSyxJQUFJLFNBQVMsSUFBSSxJQUFJLENBQUMsVUFBVSxFQUFFO1lBQ25DLElBQUk7Z0JBQ0EsSUFBSSxtQkFBbUIsR0FBRyxVQUFVLENBQUMsT0FBTyxDQUN4QyxRQUFRLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBRSxFQUM3QixTQUFTLENBQUMsSUFBSSxDQUNqQixDQUFBO2dCQUNELE9BQU8sbUJBQW1CLENBQUE7YUFDN0I7WUFBQyxPQUFPLEtBQUssRUFBRTtnQkFDWixNQUFNLENBQUMsS0FBSyxDQUFDLG9CQUFvQixFQUFFLEtBQUssQ0FBQyxDQUFBO2FBQzVDO1NBQ0o7UUFFRCxNQUFNLElBQUksS0FBSyxDQUFDLGtDQUFrQyxDQUFDLENBQUE7SUFDdkQsQ0FBQztJQUVELE9BQU8sQ0FBQyxJQUFpQixFQUFFLFFBQXNCO1FBQzdDLElBQUksVUFBVSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUE7UUFFdEMsT0FBTyxVQUFVLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUE7SUFDcEQsQ0FBQzs7QUE5Qk0seUJBQVUsR0FBRyxTQUFTLENBQUEifQ==